var $jscomp={scope:{},findInternal:function(c,h,d){c instanceof String&&(c=String(c));for(var p=c.length,l=0;l<p;l++){var m=c[l];if(h.call(d,m,l,c))return{i:l,v:m}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(c,h,d){if(d.get||d.set)throw new TypeError("ES3 does not support getters and setters.");c!=Array.prototype&&c!=Object.prototype&&(c[h]=d.value)};
$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global?global:c};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(c,h,d,p){if(h){d=$jscomp.global;c=c.split(".");for(p=0;p<c.length-1;p++){var l=c[p];l in d||(d[l]={});d=d[l]}c=c[c.length-1];p=d[c];h=h(p);h!=p&&null!=h&&$jscomp.defineProperty(d,c,{configurable:!0,writable:!0,value:h})}};
$jscomp.polyfill("Array.prototype.find",function(c){return c?c:function(c,d){return $jscomp.findInternal(this,c,d).v}},"es6-impl","es3");
(function(c,h){"function"===typeof define&&define.amd?define("sifter",h):"object"===typeof exports?module.exports=h():c.Sifter=h()})(this,function(){var c=function(c,k){this.items=c;this.settings=k||{diacritics:!0}};c.prototype.tokenize=function(c){c=(String(c||"").toLowerCase()+"").replace(/^\s+|\s+$|/g,"");if(!c||!c.length)return[];var k,f,t,r=[],d=c.split(/ +/);c=0;for(k=d.length;c<k;c++){f=(d[c]+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");if(this.settings.diacritics)for(t in m)m.hasOwnProperty(t)&&
(f=f.replace(new RegExp(t,"g"),m[t]));r.push({string:d[c],regex:new RegExp(f,"i")})}return r};c.prototype.iterator=function(c,d){(l(c)?Array.prototype.forEach||function(c){for(var f=0,d=this.length;f<d;f++)c(this[f],f,this)}:function(c){for(var f in this)this.hasOwnProperty(f)&&c(this[f],f,this)}).apply(c,[d])};c.prototype.getScoreFunction=function(c,d){var f,t,k,r;c=this.prepareSearch(c,d);t=c.tokens;f=c.options.fields;k=t.length;r=c.options.nesting;var h=function(c,f){var d,k;if(!c)return 0;c=String(c||
"");k=c.search(f.regex);if(-1===k)return 0;d=f.string.length/c.length;0===k&&(d+=.5);return d},l=function(){var c=f.length;return c?1===c?function(c,d){return h(p(d,f[0],r),c)}:function(d,k){for(var t=0,l=0;t<c;t++)l+=h(p(k,f[t],r),d);return l/c}:function(){return 0}}();return k?1===k?function(c){return l(t[0],c)}:"and"===c.options.conjunction?function(c){for(var f,d=0,r=0;d<k;d++){f=l(t[d],c);if(0>=f)return 0;r+=f}return r/k}:function(c){for(var f=0,d=0;f<k;f++)d+=l(t[f],c);return d/k}:function(){return 0}};
c.prototype.getSortFunction=function(c,d){var f,k,r,l,m,D,F,A,B,y;r=this;c=r.prepareSearch(c,d);y=!c.query&&d.sort_empty||d.sort;B=function(c,f){return"$score"===c?f.score:p(r.items[f.id],c,d.nesting)};m=[];if(y)for(f=0,k=y.length;f<k;f++)(c.query||"$score"!==y[f].field)&&m.push(y[f]);if(c.query){y=!0;f=0;for(k=m.length;f<k;f++)if("$score"===m[f].field){y=!1;break}y&&m.unshift({field:"$score",direction:"desc"})}else for(f=0,k=m.length;f<k;f++)if("$score"===m[f].field){m.splice(f,1);break}A=[];f=0;
for(k=m.length;f<k;f++)A.push("desc"===m[f].direction?-1:1);return(D=m.length)?1===D?(l=m[0].field,F=A[0],function(c,f){return F*h(B(l,c),B(l,f))}):function(c,f){var a,b;for(a=0;a<D;a++)if(b=m[a].field,b=A[a]*h(B(b,c),B(b,f)))return b;return 0}:null};c.prototype.prepareSearch=function(c,k){if("object"===typeof c)return c;k=d({},k);var f=k.fields,t=k.sort,r=k.sort_empty;f&&!l(f)&&(k.fields=[f]);t&&!l(t)&&(k.sort=[t]);r&&!l(r)&&(k.sort_empty=[r]);return{options:k,query:String(c||"").toLowerCase(),tokens:this.tokenize(c),
total:0,items:[]}};c.prototype.search=function(c,d){var f,k,r,h;k=this.prepareSearch(c,d);d=k.options;c=k.query;h=d.score||this.getScoreFunction(k);c.length?this.iterator(this.items,function(c,r){f=h(c);(!1===d.filter||0<f)&&k.items.push({score:f,id:r})}):this.iterator(this.items,function(c,f){k.items.push({score:1,id:f})});(r=this.getSortFunction(k,d))&&k.items.sort(r);k.total=k.items.length;"number"===typeof d.limit&&(k.items=k.items.slice(0,d.limit));return k};var h=function(c,d){if("number"===
typeof c&&"number"===typeof d)return c>d?1:c<d?-1:0;c=E(String(c||""));d=E(String(d||""));return c>d?1:d>c?-1:0},d=function(c,d){var f,k,h,p;f=1;for(k=arguments.length;f<k;f++)if(p=arguments[f])for(h in p)p.hasOwnProperty(h)&&(c[h]=p[h]);return c},p=function(c,d,f){if(c&&d){if(!f)return c[d];for(d=d.split(".");d.length&&(c=c[d.shift()]););return c}},l=Array.isArray||"undefined"!==typeof $&&$.isArray||function(c){return"[object Array]"===Object.prototype.toString.call(c)},m={a:"[a\u1e00\u1e01\u0102\u0103\u00c2\u00e2\u01cd\u01ce\u023a\u2c65\u0226\u0227\u1ea0\u1ea1\u00c4\u00e4\u00c0\u00e0\u00c1\u00e1\u0100\u0101\u00c3\u00e3\u00c5\u00e5\u0105\u0104\u00c3\u0105\u0104]",
b:"[b\u2422\u03b2\u0392B\u0e3f\ud800\udf01\u16d2]",c:"[c\u0106\u0107\u0108\u0109\u010c\u010d\u010a\u010bC\u0304c\u0304\u00c7\u00e7\u1e08\u1e09\u023b\u023c\u0187\u0188\u0255\u1d04\uff23\uff43]",d:"[d\u010e\u010f\u1e0a\u1e0b\u1e10\u1e11\u1e0c\u1e0d\u1e12\u1e13\u1e0e\u1e0f\u0110\u0111D\u0326d\u0326\u0189\u0256\u018a\u0257\u018b\u018c\u1d6d\u1d81\u1d91\u0221\u1d05\uff24\uff44\u00f0]",e:"[e\u00c9\u00e9\u00c8\u00e8\u00ca\u00ea\u1e18\u1e19\u011a\u011b\u0114\u0115\u1ebc\u1ebd\u1e1a\u1e1b\u1eba\u1ebb\u0116\u0117\u00cb\u00eb\u0112\u0113\u0228\u0229\u0118\u0119\u1d92\u0246\u0247\u0204\u0205\u1ebe\u1ebf\u1ec0\u1ec1\u1ec4\u1ec5\u1ec2\u1ec3\u1e1c\u1e1d\u1e16\u1e17\u1e14\u1e15\u0206\u0207\u1eb8\u1eb9\u1ec6\u1ec7\u2c78\u1d07\uff25\uff45\u0258\u01dd\u018f\u0190\u03b5]",
f:"[f\u0191\u0192\u1e1e\u1e1f]",g:"[g\u0262\u20b2\u01e4\u01e5\u011c\u011d\u011e\u011f\u0122\u0123\u0193\u0260\u0120\u0121]",h:"[h\u0124\u0125\u0126\u0127\u1e28\u1e29\u1e96\u1e96\u1e24\u1e25\u1e22\u1e23\u0266\u02b0\u01f6\u0195]",i:"[i\u00cd\u00ed\u00cc\u00ec\u012c\u012d\u00ce\u00ee\u01cf\u01d0\u00cf\u00ef\u1e2e\u1e2f\u0128\u0129\u012e\u012f\u012a\u012b\u1ec8\u1ec9\u0208\u0209\u020a\u020b\u1eca\u1ecb\u1e2c\u1e2d\u0197\u0268\u0268\u0306\u1d7b\u1d96\u0130iI\u0131\u026a\uff29\uff49]",j:"[j\u0237\u0134\u0135\u0248\u0249\u029d\u025f\u02b2]",
k:"[k\u0198\u0199\ua740\ua741\u1e30\u1e31\u01e8\u01e9\u1e32\u1e33\u1e34\u1e35\u03ba\u03f0\u20ad]",l:"[l\u0141\u0142\u013d\u013e\u013b\u013c\u0139\u013a\u1e36\u1e37\u1e38\u1e39\u1e3c\u1e3d\u1e3a\u1e3b\u013f\u0140\u023d\u019a\u2c60\u2c61\u2c62\u026b\u026c\u1d85\u026d\u0234\u029f\uff2c\uff4c]",n:"[n\u0143\u0144\u01f8\u01f9\u0147\u0148\u00d1\u00f1\u1e44\u1e45\u0145\u0146\u1e46\u1e47\u1e4a\u1e4b\u1e48\u1e49N\u0308n\u0308\u019d\u0272\u0220\u019e\u1d70\u1d87\u0273\u0235\u0274\uff2e\uff4e\u014a\u014b]",o:"[o\u00d8\u00f8\u00d6\u00f6\u00d3\u00f3\u00d2\u00f2\u00d4\u00f4\u01d1\u01d2\u0150\u0151\u014e\u014f\u022e\u022f\u1ecc\u1ecd\u019f\u0275\u01a0\u01a1\u1ece\u1ecf\u014c\u014d\u00d5\u00f5\u01ea\u01eb\u020c\u020d\u0555\u0585]",
p:"[p\u1e54\u1e55\u1e56\u1e57\u2c63\u1d7d\u01a4\u01a5\u1d71]",q:"[q\ua756\ua757\u02a0\u024a\u024b\ua758\ua759q\u0303]",r:"[r\u0154\u0155\u024c\u024d\u0158\u0159\u0156\u0157\u1e58\u1e59\u0210\u0211\u0212\u0213\u1e5a\u1e5b\u2c64\u027d]",s:"[s\u015a\u015b\u1e60\u1e61\u1e62\u1e63\ua7a8\ua7a9\u015c\u015d\u0160\u0161\u015e\u015f\u0218\u0219S\u0308s\u0308]",t:"[t\u0164\u0165\u1e6a\u1e6b\u0162\u0163\u1e6c\u1e6d\u01ae\u0288\u021a\u021b\u1e70\u1e71\u1e6e\u1e6f\u01ac\u01ad]",u:"[u\u016c\u016d\u0244\u0289\u1ee4\u1ee5\u00dc\u00fc\u00da\u00fa\u00d9\u00f9\u00db\u00fb\u01d3\u01d4\u0170\u0171\u016c\u016d\u01af\u01b0\u1ee6\u1ee7\u016a\u016b\u0168\u0169\u0172\u0173\u0214\u0215\u222a]",
v:"[v\u1e7c\u1e7d\u1e7e\u1e7f\u01b2\u028b\ua75e\ua75f\u2c71\u028b]",w:"[w\u1e82\u1e83\u1e80\u1e81\u0174\u0175\u1e84\u1e85\u1e86\u1e87\u1e88\u1e89]",x:"[x\u1e8c\u1e8d\u1e8a\u1e8b\u03c7]",y:"[y\u00dd\u00fd\u1ef2\u1ef3\u0176\u0177\u0178\u00ff\u1ef8\u1ef9\u1e8e\u1e8f\u1ef4\u1ef5\u024e\u024f\u01b3\u01b4]",z:"[z\u0179\u017a\u1e90\u1e91\u017d\u017e\u017b\u017c\u1e92\u1e93\u1e94\u1e95\u01b5\u01b6]"},E=function(){var c,d,f,h,p="",l={};for(f in m)if(m.hasOwnProperty(f))for(h=m[f].substring(2,m[f].length-1),
p+=h,c=0,d=h.length;c<d;c++)l[h.charAt(c)]=f;var E=new RegExp("["+p+"]","g");return function(c){return c.replace(E,function(c){return l[c]}).toLowerCase()}}();return c});
(function(c,h){"function"===typeof define&&define.amd?define("microplugin",h):"object"===typeof exports?module.exports=h():c.MicroPlugin=h()})(this,function(){var c={isArray:Array.isArray||function(c){return"[object Array]"===Object.prototype.toString.call(c)}};return{mixin:function(h){h.plugins={};h.prototype.initializePlugins=function(d){var h,l,m=[];this.plugins={names:[],settings:{},requested:{},loaded:{}};if(c.isArray(d))for(h=0,l=d.length;h<l;h++)"string"===typeof d[h]?m.push(d[h]):(this.plugins.settings[d[h].name]=
d[h].options,m.push(d[h].name));else if(d)for(h in d)d.hasOwnProperty(h)&&(this.plugins.settings[h]=d[h],m.push(h));for(;m.length;)this.require(m.shift())};h.prototype.loadPlugin=function(c){var d=this.plugins,l=h.plugins[c];if(!h.plugins.hasOwnProperty(c))throw Error('Unable to find "'+c+'" plugin');d.requested[c]=!0;d.loaded[c]=l.fn.apply(this,[this.plugins.settings[c]||{}]);d.names.push(c)};h.prototype.require=function(c){var d=this.plugins;if(!this.plugins.loaded.hasOwnProperty(c)){if(d.requested[c])throw Error('Plugin has circular dependency ("'+
c+'")');this.loadPlugin(c)}return d.loaded[c]};h.define=function(c,p){h.plugins[c]={name:c,fn:p}}}}});
(function(c,h){"function"===typeof define&&define.amd?define("selectize",["jquery","sifter","microplugin"],h):"object"===typeof exports?module.exports=h(require("jquery"),require("sifter"),require("microplugin")):c.Selectize=h(c.jQuery,c.Sifter,c.MicroPlugin)})(this,function(c,h,d){var p=function(a,b){if("string"!==typeof b||b.length){var e="string"===typeof b?new RegExp(b,"i"):b,c=function(a){var b=0;if(3===a.nodeType){var g=a.data.search(e);if(0<=g&&0<a.data.length){var n=a.data.match(e),b=document.createElement("span");
b.className="highlight";a=a.splitText(g);a.splitText(n[0].length);g=a.cloneNode(!0);b.appendChild(g);a.parentNode.replaceChild(b,a);b=1}}else if(1===a.nodeType&&a.childNodes&&!/(script|style)/i.test(a.tagName))for(g=0;g<a.childNodes.length;++g)g+=c(a.childNodes[g]);return b};return a.each(function(){c(this)})}};c.fn.removeHighlight=function(){return this.find("span.highlight").each(function(){this.parentNode.firstChild.nodeName;var a=this.parentNode;a.replaceChild(this.firstChild,this);a.normalize()}).end()};
var l=function(){};l.prototype={on:function(a,b){this._events=this._events||{};this._events[a]=this._events[a]||[];this._events[a].push(b)},off:function(a,b){var e=arguments.length;if(0===e)return delete this._events;if(1===e)return delete this._events[a];this._events=this._events||{};!1!==a in this._events&&this._events[a].splice(this._events[a].indexOf(b),1)},trigger:function(a){this._events=this._events||{};if(!1!==a in this._events)for(var b=0;b<this._events[a].length;b++)this._events[a][b].apply(this,
Array.prototype.slice.call(arguments,1))}};l.mixin=function(a){for(var b=["on","off","trigger"],e=0;e<b.length;e++)a.prototype[b[e]]=l.prototype[b[e]]};var m=/Mac/.test(navigator.userAgent),E=m?91:17,r=m?18:17,k=!/android/i.test(window.navigator.userAgent)&&!!document.createElement("input").validity,f=function(a){return"undefined"===typeof a||null===a?null:"boolean"===typeof a?a?"1":"0":a+""},t=function(a){return(a+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},
G={before:function(a,b,e){var c=a[b];a[b]=function(){e.apply(a,arguments);return c.apply(a,arguments)}},after:function(a,b,e){var c=a[b];a[b]=function(){var b=c.apply(a,arguments);e.apply(a,arguments);return b}}},I=function(a){var b=!1;return function(){b||(b=!0,a.apply(this,arguments))}},J=function(a,b){var e;return function(){var c=this,n=arguments;window.clearTimeout(e);e=window.setTimeout(function(){a.apply(c,n)},b)}},D=function(a,b,e){var c,n=a.trigger,C={};a.trigger=function(){var e=arguments[0];
if(-1!==b.indexOf(e))C[e]=arguments;else return n.apply(a,arguments)};e.apply(a,[]);a.trigger=n;for(c in C)C.hasOwnProperty(c)&&n.apply(a,C[c])},F=function(a,b,e,c){a.on(b,e,function(b){for(var e=b.target;e&&e.parentNode!==a[0];)e=e.parentNode;b.currentTarget=e;return c.apply(this,[b])})},A=function(a){var b={};if("selectionStart"in a)b.start=a.selectionStart,b.length=a.selectionEnd-b.start;else if(document.selection){a.focus();var e=document.selection.createRange(),c=document.selection.createRange().text.length;
e.moveStart("character",-a.value.length);b.start=e.text.length-c;b.length=c}return b},B=function(a){var b=null,e=function(e,n){var g,d,f;e=e||window.event||{};n=n||{};if(!e.metaKey&&!e.altKey&&(n.force||!1!==a.data("grow"))){g=a.val();e.type&&"keydown"===e.type.toLowerCase()&&(d=e.keyCode,f=97<=d&&122>=d||65<=d&&90>=d||48<=d&&57>=d||32===d,46===d||8===d?(f=A(a[0]),f.length?g=g.substring(0,f.start)+g.substring(f.start+f.length):8===d&&f.start?g=g.substring(0,f.start-1)+g.substring(f.start+1):46===
d&&"undefined"!==typeof f.start&&(g=g.substring(0,f.start)+g.substring(f.start+1))):f&&(d=e.shiftKey,f=String.fromCharCode(e.keyCode),f=d?f.toUpperCase():f.toLowerCase(),g+=f));d=a.attr("placeholder");!g&&d&&(g=d);if(g){g=c("<test>").css({position:"absolute",top:-99999,left:-99999,width:"auto",padding:0,whiteSpace:"pre"}).text(g).appendTo("body");d=["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"];var h,k={};if(d)for(f=0,h=d.length;f<h;f++)k[d[f]]=a.css(d[f]);else k=a.css();g.css(k);
d=g.width();g.remove();g=d}else g=0;g+=4;g!==b&&(b=g,a.width(g),a.triggerHandler("resize"))}};a.on("keydown keyup update blur",e);e()},y=function(a){var b=document.createElement("div");b.appendChild(a.cloneNode(!0));return b.innerHTML},K=function(a,b){b||(b={});console.error("Selectize: "+a);b.explanation&&(console.group&&console.group(),console.error(b.explanation),console.group&&console.groupEnd())},w=function(a,b){var e,g;e=a[0];e.selectize=this;g=(g=(g=window.getComputedStyle&&window.getComputedStyle(e,
null))?g.getPropertyValue("direction"):e.currentStyle&&e.currentStyle.direction)||a.parents("[dir]:first").attr("dir")||"";c.extend(this,{order:0,settings:b,$input:a,tabIndex:a.attr("tabindex")||"",tagType:"select"===e.tagName.toLowerCase()?1:2,rtl:/rtl/i.test(g),eventNS:".selectize"+ ++w.count,highlightedValue:null,isOpen:!1,isDisabled:!1,isRequired:a.is("[required]"),isInvalid:!1,isLocked:!1,isFocused:!1,isInputHidden:!1,isSetup:!1,isShiftDown:!1,isCmdDown:!1,isCtrlDown:!1,ignoreFocus:!1,ignoreBlur:!1,
ignoreHover:!1,hasOptions:!1,currentResults:null,lastValue:"",caretPos:0,loading:0,loadedSearches:{},$activeOption:null,$activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{},onSearchChange:null===b.loadThrottle?this.onSearchChange:J(this.onSearchChange,b.loadThrottle)});this.sifter=new h(this.options,{diacritics:b.diacritics});if(this.settings.options){e=0;for(g=this.settings.options.length;e<g;e++)this.registerOption(this.settings.options[e]);delete this.settings.options}if(this.settings.optgroups){e=
0;for(g=this.settings.optgroups.length;e<g;e++)this.registerOptionGroup(this.settings.optgroups[e]);delete this.settings.optgroups}this.settings.mode=this.settings.mode||(1===this.settings.maxItems?"single":"multi");"boolean"!==typeof this.settings.hideSelected&&(this.settings.hideSelected="multi"===this.settings.mode);this.initializePlugins(this.settings.plugins);this.setupCallbacks();this.setupTemplates();this.setup()};l.mixin(w);"undefined"!==typeof d?d.mixin(w):K("Dependency MicroPlugin is missing",
{explanation:'Make sure you either: (1) are using the "standalone" version of Selectize, or (2) require MicroPlugin before you load Selectize.'});c.extend(w.prototype,{setup:function(){var a=this,b=a.settings,e=a.eventNS,g=c(window),n=c(document),d=a.$input,f,h,l,p,x,v,z;x=a.settings.mode;v=d.attr("class")||"";f=c("<div>").addClass(b.wrapperClass).addClass(v).addClass(x);h=c("<div>").addClass(b.inputClass).addClass("items").appendTo(f);l=c('<input type="text" autocomplete="off" />').appendTo(h).attr("tabindex",
d.is(":disabled")?"-1":a.tabIndex);p=c(b.dropdownParent||f);p=c("<div>").addClass(b.dropdownClass).addClass(x).hide().appendTo(p);x=c("<div>").addClass(b.dropdownContentClass).appendTo(p);if(z=d.attr("id"))l.attr("id",z+"-selectized"),c("label[for='"+z+"']").attr("for",z+"-selectized");a.settings.copyClassesToDropdown&&p.addClass(v);f.css({width:d[0].style.width});a.plugins.names.length&&(v="plugin-"+a.plugins.names.join(" plugin-"),f.addClass(v),p.addClass(v));(null===b.maxItems||1<b.maxItems)&&
1===a.tagType&&d.attr("multiple","multiple");a.settings.placeholder&&l.attr("placeholder",b.placeholder);!a.settings.splitOn&&a.settings.delimiter&&(v=a.settings.delimiter.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),a.settings.splitOn=new RegExp("\\s*"+v+"+\\s*"));d.attr("autocorrect")&&l.attr("autocorrect",d.attr("autocorrect"));d.attr("autocapitalize")&&l.attr("autocapitalize",d.attr("autocapitalize"));a.$wrapper=f;a.$control=h;a.$control_input=l;a.$dropdown=p;a.$dropdown_content=x;p.on("mouseenter",
"[data-selectable]",function(){return a.onOptionHover.apply(a,arguments)});p.on("mousedown click","[data-selectable]",function(){return a.onOptionSelect.apply(a,arguments)});F(h,"mousedown","*:not(input)",function(){return a.onItemSelect.apply(a,arguments)});B(l);h.on({mousedown:function(){return a.onMouseDown.apply(a,arguments)},click:function(){return a.onClick.apply(a,arguments)}});l.on({mousedown:function(a){a.stopPropagation()},keydown:function(){return a.onKeyDown.apply(a,arguments)},keyup:function(){return a.onKeyUp.apply(a,
arguments)},keypress:function(){return a.onKeyPress.apply(a,arguments)},resize:function(){a.positionDropdown.apply(a,[])},blur:function(){return a.onBlur.apply(a,arguments)},focus:function(){a.ignoreBlur=!1;return a.onFocus.apply(a,arguments)},paste:function(){return a.onPaste.apply(a,arguments)}});n.on("keydown"+e,function(b){a.isCmdDown=b[m?"metaKey":"ctrlKey"];a.isCtrlDown=b[m?"altKey":"ctrlKey"];a.isShiftDown=b.shiftKey});n.on("keyup"+e,function(b){b.keyCode===r&&(a.isCtrlDown=!1);16===b.keyCode&&
(a.isShiftDown=!1);b.keyCode===E&&(a.isCmdDown=!1)});n.on("mousedown"+e,function(b){if(a.isFocused){if(b.target===a.$dropdown[0]||b.target.parentNode===a.$dropdown[0])return!1;a.$control.has(b.target).length||b.target===a.$control[0]||a.blur(b.target)}});g.on(["scroll"+e,"resize"+e].join(" "),function(){a.isOpen&&a.positionDropdown.apply(a,arguments)});g.on("mousemove"+e,function(){a.ignoreHover=!1});this.revertSettings={$children:d.children().detach(),tabindex:d.attr("tabindex")};d.attr("tabindex",
-1).hide().after(a.$wrapper);c.isArray(b.items)&&(a.setValue(b.items),delete b.items);if(k)d.on("invalid"+e,function(b){b.preventDefault();a.isInvalid=!0;a.refreshState()});a.updateOriginalInput();a.refreshItems();a.refreshState();a.updatePlaceholder();a.isSetup=!0;d.is(":disabled")&&a.disable();a.on("change",this.onChange);d.data("selectize",a);d.addClass("selectized");a.trigger("initialize");if(!0===b.preload)a.onSearchChange("")},setupTemplates:function(){var a=this.settings.labelField,b=this.settings.optgroupLabelField;
this.settings.render=c.extend({},{optgroup:function(a){return'<div class="optgroup">'+a.html+"</div>"},optgroup_header:function(a,c){return'<div class="optgroup-header">'+c(a[b])+"</div>"},option:function(b,c){return'<div class="option">'+c(b[a])+"</div>"},item:function(b,c){return'<div class="item">'+c(b[a])+"</div>"},option_create:function(a,b){return'<div class="create">Add <strong>'+b(a.input)+"</strong>&hellip;</div>"}},this.settings.render)},setupCallbacks:function(){var a,b,e={initialize:"onInitialize",
change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(a in e)if(e.hasOwnProperty(a)&&(b=this.settings[e[a]]))this.on(a,b)},onClick:function(a){this.isFocused||
(this.focus(),a.preventDefault())},onMouseDown:function(a){var b=this,e=a.isDefaultPrevented();c(a.target);if(b.isFocused){if(a.target!==b.$control_input[0])return"single"===b.settings.mode?b.isOpen?b.close():b.open():e||b.setActiveItem(null),!1}else e||window.setTimeout(function(){b.focus()},0)},onChange:function(){this.$input.trigger("change")},onPaste:function(a){var b=this;b.isFull()||b.isInputHidden||b.isLocked?a.preventDefault():b.settings.splitOn&&setTimeout(function(){var a=b.$control_input.val();
if(a.match(b.settings.splitOn))for(var a=c.trim(a).split(b.settings.splitOn),g=0,d=a.length;g<d;g++)b.createItem(a[g])},0)},onKeyPress:function(a){if(this.isLocked)return a&&a.preventDefault();var b=String.fromCharCode(a.keyCode||a.which);if(this.settings.create&&"multi"===this.settings.mode&&b===this.settings.delimiter)return this.createItem(),a.preventDefault(),!1},onKeyDown:function(a){if(this.isLocked)9!==a.keyCode&&a.preventDefault();else{switch(a.keyCode){case 65:if(this.isCmdDown){this.selectAll();
return}break;case 27:this.isOpen&&(a.preventDefault(),a.stopPropagation(),this.close());return;case 78:if(!a.ctrlKey||a.altKey)break;case 40:if(!this.isOpen&&this.hasOptions)this.open();else if(this.$activeOption){this.ignoreHover=!0;var b=this.getAdjacentOption(this.$activeOption,1);b.length&&this.setActiveOption(b,!0,!0)}a.preventDefault();return;case 80:if(!a.ctrlKey||a.altKey)break;case 38:this.$activeOption&&(this.ignoreHover=!0,b=this.getAdjacentOption(this.$activeOption,-1),b.length&&this.setActiveOption(b,
!0,!0));a.preventDefault();return;case 13:this.isOpen&&this.$activeOption&&(this.onOptionSelect({currentTarget:this.$activeOption}),a.preventDefault());return;case 37:this.advanceSelection(-1,a);return;case 39:this.advanceSelection(1,a);return;case 9:this.settings.selectOnTab&&this.isOpen&&this.$activeOption&&(this.onOptionSelect({currentTarget:this.$activeOption}),this.isFull()||a.preventDefault());this.settings.create&&this.createItem()&&a.preventDefault();return;case 8:case 46:this.deleteSelection(a);
return}!this.isFull()&&!this.isInputHidden||(m?a.metaKey:a.ctrlKey)||a.preventDefault()}},onKeyUp:function(a){if(this.isLocked)return a&&a.preventDefault();a=this.$control_input.val()||"";this.lastValue!==a&&(this.lastValue=a,this.onSearchChange(a),this.refreshOptions(),this.trigger("type",a))},onSearchChange:function(a){var b=this,e=b.settings.load;e&&!b.loadedSearches.hasOwnProperty(a)&&(b.loadedSearches[a]=!0,b.load(function(c){e.apply(b,[a,c])}))},onFocus:function(a){var b=this.isFocused;if(this.isDisabled)return this.blur(),
a&&a.preventDefault(),!1;if(!this.ignoreFocus){this.isFocused=!0;if("focus"===this.settings.preload)this.onSearchChange("");b||this.trigger("focus");this.$activeItems.length||(this.showInput(),this.setActiveItem(null),this.refreshOptions(!!this.settings.openOnFocus));this.refreshState()}},onBlur:function(a,b){var e=this;if(e.isFocused&&(e.isFocused=!1,!e.ignoreFocus))if(e.ignoreBlur||document.activeElement!==e.$dropdown_content[0]){var c=function(){e.close();e.setTextboxValue("");e.setActiveItem(null);
e.setActiveOption(null);e.setCaret(e.items.length);e.refreshState();b&&b.focus&&b.focus();e.ignoreFocus=!1;e.trigger("blur")};e.ignoreFocus=!0;e.settings.create&&e.settings.createOnBlur?e.createItem(null,!1,c):c()}else e.ignoreBlur=!0,e.onFocus(a)},onOptionHover:function(a){this.ignoreHover||this.setActiveOption(a.currentTarget,!1)},onOptionSelect:function(a){var b,e=this;a.preventDefault&&(a.preventDefault(),a.stopPropagation());b=c(a.currentTarget);b.hasClass("create")?e.createItem(null,function(){e.settings.closeAfterSelect&&
e.close()}):(b=b.attr("data-value"),"undefined"!==typeof b&&(e.lastQuery=null,e.setTextboxValue(""),e.addItem(b),e.settings.closeAfterSelect?e.close():!e.settings.hideSelected&&a.type&&/mouse/.test(a.type)&&e.setActiveOption(e.getOption(b))))},onItemSelect:function(a){this.isLocked||"multi"!==this.settings.mode||(a.preventDefault(),this.setActiveItem(a.currentTarget,a))},load:function(a){var b=this,e=b.$wrapper.addClass(b.settings.loadingClass);b.loading++;a.apply(b,[function(a){b.loading=Math.max(b.loading-
1,0);a&&a.length&&(b.addOption(a),b.refreshOptions(b.isFocused&&!b.isInputHidden));b.loading||e.removeClass(b.settings.loadingClass);b.trigger("load",a)}])},setTextboxValue:function(a){var b=this.$control_input;b.val()!==a&&(b.val(a).triggerHandler("update"),this.lastValue=a)},getValue:function(){return 1===this.tagType&&this.$input.attr("multiple")?this.items:this.items.join(this.settings.delimiter)},setValue:function(a,b){D(this,b?[]:["change"],function(){this.clear(b);this.addItems(a,b)})},setActiveItem:function(a,
b){var e,g,d;if("single"!==this.settings.mode)if(a=c(a),a.length){e=b&&b.type.toLowerCase();if("mousedown"===e&&this.isShiftDown&&this.$activeItems.length){e=this.$control.children(".active:last");g=Array.prototype.indexOf.apply(this.$control[0].childNodes,[e[0]]);e=Array.prototype.indexOf.apply(this.$control[0].childNodes,[a[0]]);g>e&&(d=g,g=e,e=d);for(;g<=e;g++)d=this.$control[0].childNodes[g],-1===this.$activeItems.indexOf(d)&&(c(d).addClass("active"),this.$activeItems.push(d));b.preventDefault()}else"mousedown"===
e&&this.isCtrlDown||"keydown"===e&&this.isShiftDown?a.hasClass("active")?(e=this.$activeItems.indexOf(a[0]),this.$activeItems.splice(e,1),a.removeClass("active")):this.$activeItems.push(a.addClass("active")[0]):(c(this.$activeItems).removeClass("active"),this.$activeItems=[a.addClass("active")[0]]);this.hideInput();this.isFocused||this.focus()}else c(this.$activeItems).removeClass("active"),this.$activeItems=[],this.isFocused&&this.showInput()},setActiveOption:function(a,b,e){var g,d,f;this.$activeOption&&
this.$activeOption.removeClass("active");this.$activeOption=null;a=c(a);a.length&&(this.$activeOption=a.addClass("active"),b||"undefined"===typeof b)&&(a=this.$dropdown_content.height(),g=this.$activeOption.outerHeight(!0),b=this.$dropdown_content.scrollTop()||0,d=this.$activeOption.offset().top-this.$dropdown_content.offset().top+b,f=d-a+g,d+g>a+b?this.$dropdown_content.stop().animate({scrollTop:f},e?this.settings.scrollDuration:0):d<b&&this.$dropdown_content.stop().animate({scrollTop:d},e?this.settings.scrollDuration:
0))},selectAll:function(){"single"!==this.settings.mode&&(this.$activeItems=Array.prototype.slice.apply(this.$control.children(":not(input)").addClass("active")),this.$activeItems.length&&(this.hideInput(),this.close()),this.focus())},hideInput:function(){this.setTextboxValue("");this.$control_input.css({opacity:0,position:"absolute",left:this.rtl?1E4:-1E4});this.isInputHidden=!0},showInput:function(){this.$control_input.css({opacity:1,position:"relative",left:0});this.isInputHidden=!1},focus:function(){var a=
this;a.isDisabled||(a.ignoreFocus=!0,a.$control_input[0].focus(),window.setTimeout(function(){a.ignoreFocus=!1;a.onFocus()},0))},blur:function(a){this.$control_input[0].blur();this.onBlur(null,a)},getScoreFunction:function(a){return this.sifter.getScoreFunction(a,this.getSearchOptions())},getSearchOptions:function(){var a=this.settings,b=a.sortField;"string"===typeof b&&(b=[{field:b}]);return{fields:a.searchField,conjunction:a.searchConjunction,sort:b}},search:function(a){var b,e;b=this.settings;
var g=this.getSearchOptions();if(b.score&&(e=this.settings.score.apply(this,[a]),"function"!==typeof e))throw Error('Selectize "score" setting must be a function that returns a function');a!==this.lastQuery?(this.lastQuery=a,this.currentResults=a=this.sifter.search(a,c.extend(g,{score:e}))):a=c.extend(!0,{},this.currentResults);if(b.hideSelected)for(b=a.items.length-1;0<=b;b--)-1!==this.items.indexOf(f(a.items[b].id))&&a.items.splice(b,1);return a},refreshOptions:function(a){var b,e,g,d,h,k,u,l,m,
x,v,z;"undefined"===typeof a&&(a=!0);var q=this;v=c.trim(q.$control_input.val());var r=q.search(v),t=q.$dropdown_content,w=q.$activeOption&&f(q.$activeOption.attr("data-value"));d=r.items.length;"number"===typeof q.settings.maxOptions&&(d=Math.min(d,q.settings.maxOptions));h={};k=[];for(b=0;b<d;b++)for(u=q.options[r.items[b].id],l=q.render("option",u),u=u[q.settings.optgroupField]||"",m=c.isArray(u)?u:[u],e=0,g=m&&m.length;e<g;e++)u=m[e],q.optgroups.hasOwnProperty(u)||(u=""),h.hasOwnProperty(u)||
(h[u]=document.createDocumentFragment(),k.push(u)),h[u].appendChild(l);this.settings.lockOptgroupOrder&&k.sort(function(a,b){return(q.optgroups[a].$order||0)-(q.optgroups[b].$order||0)});l=document.createDocumentFragment();b=0;for(d=k.length;b<d;b++)u=k[b],q.optgroups.hasOwnProperty(u)&&h[u].childNodes.length?(e=document.createDocumentFragment(),e.appendChild(q.render("optgroup_header",q.optgroups[u])),e.appendChild(h[u]),l.appendChild(q.render("optgroup",c.extend({},q.optgroups[u],{html:y(e),dom:e})))):
l.appendChild(h[u]);t.html(l);if(q.settings.highlight&&r.query.length&&r.tokens.length)for(t.removeHighlight(),b=0,d=r.tokens.length;b<d;b++)p(t,r.tokens[b].regex);if(!q.settings.hideSelected)for(b=0,d=q.items.length;b<d;b++)q.getOption(q.items[b]).addClass("selected");if(b=q.canCreate(v))t.prepend(q.render("option_create",{input:v})),z=c(t[0].childNodes[0]);q.hasOptions=0<r.items.length||b;q.hasOptions?(0<r.items.length?((v=w&&q.getOption(w))&&v.length?x=v:"single"===q.settings.mode&&q.items.length&&
(x=q.getOption(q.items[0])),x&&x.length||(x=z&&!q.settings.addPrecedence?q.getAdjacentOption(z,1):t.find("[data-selectable]:first"))):x=z,q.setActiveOption(x),a&&!q.isOpen&&q.open()):(q.setActiveOption(null),a&&q.isOpen&&q.close())},addOption:function(a){var b,e;if(c.isArray(a))for(b=0,e=a.length;b<e;b++)this.addOption(a[b]);else if(b=this.registerOption(a))this.userOptions[b]=!0,this.lastQuery=null,this.trigger("option_add",b,a)},registerOption:function(a){var b=f(a[this.settings.valueField]);if("undefined"===
typeof b||null===b||this.options.hasOwnProperty(b))return!1;a.$order=a.$order||++this.order;this.options[b]=a;return b},registerOptionGroup:function(a){var b=f(a[this.settings.optgroupValueField]);if(!b)return!1;a.$order=a.$order||++this.order;this.optgroups[b]=a;return b},addOptionGroup:function(a,b){b[this.settings.optgroupValueField]=a;(a=this.registerOptionGroup(b))&&this.trigger("optgroup_add",a,b)},removeOptionGroup:function(a){this.optgroups.hasOwnProperty(a)&&(delete this.optgroups[a],this.renderCache=
{},this.trigger("optgroup_remove",a))},clearOptionGroups:function(){this.optgroups={};this.renderCache={};this.trigger("optgroup_clear")},updateOption:function(a,b){var e,g,d;a=f(a);e=f(b[this.settings.valueField]);if(null!==a&&this.options.hasOwnProperty(a)){if("string"!==typeof e)throw Error("Value must be set in option data");d=this.options[a].$order;e!==a&&(delete this.options[a],g=this.items.indexOf(a),-1!==g&&this.items.splice(g,1,e));b.$order=b.$order||d;this.options[e]=b;g=this.renderCache.item;
d=this.renderCache.option;g&&(delete g[a],delete g[e]);d&&(delete d[a],delete d[e]);-1!==this.items.indexOf(e)&&(e=this.getItem(a),g=c(this.render("item",b)),e.hasClass("active")&&g.addClass("active"),e.replaceWith(g));this.lastQuery=null;this.isOpen&&this.refreshOptions(!1)}},removeOption:function(a,b){a=f(a);var e=this.renderCache.item,c=this.renderCache.option;e&&delete e[a];c&&delete c[a];delete this.userOptions[a];delete this.options[a];this.lastQuery=null;this.trigger("option_remove",a);this.removeItem(a,
b)},clearOptions:function(){this.loadedSearches={};this.userOptions={};this.renderCache={};this.options=this.sifter.items={};this.lastQuery=null;this.trigger("option_clear");this.clear()},getOption:function(a){return this.getElementWithValue(a,this.$dropdown_content.find("[data-selectable]"))},getAdjacentOption:function(a,b){var e=this.$dropdown.find("[data-selectable]"),g=e.index(a)+b;return 0<=g&&g<e.length?e.eq(g):c()},getElementWithValue:function(a,b){a=f(a);if("undefined"!==typeof a&&null!==
a)for(var e=0,g=b.length;e<g;e++)if(b[e].getAttribute("data-value")===a)return c(b[e]);return c()},getItem:function(a){return this.getElementWithValue(a,this.$control.children())},addItems:function(a,b){for(var e=c.isArray(a)?a:[a],g=0,d=e.length;g<d;g++)this.isPending=g<d-1,this.addItem(e[g],b)},addItem:function(a,b){D(this,b?[]:["change"],function(){var e,g,d,h=this.settings.mode;a=f(a);-1!==this.items.indexOf(a)?"single"===h&&this.close():this.options.hasOwnProperty(a)&&("single"===h&&this.clear(b),
"multi"===h&&this.isFull()||(e=c(this.render("item",this.options[a])),d=this.isFull(),this.items.splice(this.caretPos,0,a),this.insertAtCaret(e),(!this.isPending||!d&&this.isFull())&&this.refreshState(),this.isSetup&&(d=this.$dropdown_content.find("[data-selectable]"),this.isPending||(g=this.getOption(a),g=this.getAdjacentOption(g,1).attr("data-value"),this.refreshOptions(this.isFocused&&"single"!==h),g&&this.setActiveOption(this.getOption(g))),!d.length||this.isFull()?this.close():this.positionDropdown(),
this.updatePlaceholder(),this.trigger("item_add",a,e),this.updateOriginalInput({silent:b}))))})},removeItem:function(a,b){var e,g,d;e=a instanceof c?a:this.getItem(a);a=f(e.attr("data-value"));g=this.items.indexOf(a);-1!==g&&(e.remove(),e.hasClass("active")&&(d=this.$activeItems.indexOf(e[0]),this.$activeItems.splice(d,1)),this.items.splice(g,1),this.lastQuery=null,!this.settings.persist&&this.userOptions.hasOwnProperty(a)&&this.removeOption(a,b),g<this.caretPos&&this.setCaret(this.caretPos-1),this.refreshState(),
this.updatePlaceholder(),this.updateOriginalInput({silent:b}),this.positionDropdown(),this.trigger("item_remove",a,e))},createItem:function(a,b){var e=this,g=e.caretPos;a=a||c.trim(e.$control_input.val()||"");var d=arguments[arguments.length-1];"function"!==typeof d&&(d=function(){});"boolean"!==typeof b&&(b=!0);if(!e.canCreate(a))return d(),!1;e.lock();var h="function"===typeof e.settings.create?this.settings.create:function(a){var b={};b[e.settings.labelField]=a;b[e.settings.valueField]=a;return b},
k=I(function(a){e.unlock();if(!a||"object"!==typeof a)return d();var c=f(a[e.settings.valueField]);if("string"!==typeof c)return d();e.setTextboxValue("");e.addOption(a);e.setCaret(g);e.addItem(c);e.refreshOptions(b&&"single"!==e.settings.mode);d(a)}),h=h.apply(this,[a,k]);"undefined"!==typeof h&&k(h);return!0},refreshItems:function(){this.lastQuery=null;this.isSetup&&this.addItem(this.items);this.refreshState();this.updateOriginalInput()},refreshState:function(){this.refreshValidityState();this.refreshClasses()},
refreshValidityState:function(){if(!this.isRequired)return!1;var a=!this.items.length;this.isInvalid=a;this.$control_input.prop("required",a);this.$input.prop("required",!a)},refreshClasses:function(){var a=this.isFull(),b=this.isLocked;this.$wrapper.toggleClass("rtl",this.rtl);this.$control.toggleClass("focus",this.isFocused).toggleClass("disabled",this.isDisabled).toggleClass("required",this.isRequired).toggleClass("invalid",this.isInvalid).toggleClass("locked",b).toggleClass("full",a).toggleClass("not-full",
!a).toggleClass("input-active",this.isFocused&&!this.isInputHidden).toggleClass("dropdown-active",this.isOpen).toggleClass("has-options",!c.isEmptyObject(this.options)).toggleClass("has-items",0<this.items.length);this.$control_input.data("grow",!a&&!b)},isFull:function(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems},updateOriginalInput:function(a){var b,c,d,f;a=a||{};if(1===this.tagType){d=[];b=0;for(c=this.items.length;b<c;b++)f=this.options[this.items[b]][this.settings.labelField]||
"",d.push('<option value="'+t(this.items[b])+'" selected="selected">'+t(f)+"</option>");d.length||this.$input.attr("multiple")||d.push('<option value="" selected="selected"></option>');this.$input.html(d.join(""))}else this.$input.val(this.getValue()),this.$input.attr("value",this.$input.val());this.isSetup&&(a.silent||this.trigger("change",this.$input.val()))},updatePlaceholder:function(){if(this.settings.placeholder){var a=this.$control_input;this.items.length?a.removeAttr("placeholder"):a.attr("placeholder",
this.settings.placeholder);a.triggerHandler("update",{force:!0})}},open:function(){this.isLocked||this.isOpen||"multi"===this.settings.mode&&this.isFull()||(this.focus(),this.isOpen=!0,this.refreshState(),this.$dropdown.css({visibility:"hidden",display:"block"}),this.positionDropdown(),this.$dropdown.css({visibility:"visible"}),this.trigger("dropdown_open",this.$dropdown))},close:function(){var a=this.isOpen;"single"===this.settings.mode&&this.items.length&&(this.hideInput(),this.$control_input.blur());
this.isOpen=!1;this.$dropdown.hide();this.setActiveOption(null);this.refreshState();a&&this.trigger("dropdown_close",this.$dropdown)},positionDropdown:function(){var a=this.$control,b="body"===this.settings.dropdownParent?a.offset():a.position();b.top+=a.outerHeight(!0);this.$dropdown.css({width:a.outerWidth(),top:b.top,left:b.left})},clear:function(a){this.items.length&&(this.$control.children(":not(input)").remove(),this.items=[],this.lastQuery=null,this.setCaret(0),this.setActiveItem(null),this.updatePlaceholder(),
this.updateOriginalInput({silent:a}),this.refreshState(),this.showInput(),this.trigger("clear"))},insertAtCaret:function(a){var b=Math.min(this.caretPos,this.items.length);0===b?this.$control.prepend(a):c(this.$control[0].childNodes[b]).before(a);this.setCaret(b+1)},deleteSelection:function(a){var b,e,d,f,h;b=a&&8===a.keyCode?-1:1;e=A(this.$control_input[0]);this.$activeOption&&!this.settings.hideSelected&&(h=this.getAdjacentOption(this.$activeOption,-1).attr("data-value"));d=[];if(this.$activeItems.length){f=
this.$control.children(".active:"+(0<b?"last":"first"));f=this.$control.children(":not(input)").index(f);0<b&&f++;b=0;for(e=this.$activeItems.length;b<e;b++)d.push(c(this.$activeItems[b]).attr("data-value"));a&&(a.preventDefault(),a.stopPropagation())}else(this.isFocused||"single"===this.settings.mode)&&this.items.length&&(0>b&&0===e.start&&0===e.length?d.push(this.items[this.caretPos-1]):0<b&&e.start===this.$control_input.val().length&&d.push(this.items[this.caretPos]));if(!d.length||"function"===
typeof this.settings.onDelete&&!1===this.settings.onDelete.apply(this,[d]))return!1;for("undefined"!==typeof f&&this.setCaret(f);d.length;)this.removeItem(d.pop());this.showInput();this.positionDropdown();this.refreshOptions(!0);h&&(a=this.getOption(h),a.length&&this.setActiveOption(a));return!0},advanceSelection:function(a,b){var c,d;0!==a&&(this.rtl&&(a*=-1),c=0<a?"last":"first",d=A(this.$control_input[0]),this.isFocused&&!this.isInputHidden?(c=this.$control_input.val().length,(d=0>a?0===d.start&&
0===d.length:d.start===c)&&!c&&this.advanceCaret(a,b)):(d=this.$control.children(".active:"+c),d.length&&(d=this.$control.children(":not(input)").index(d),this.setActiveItem(null),this.setCaret(0<a?d+1:d))))},advanceCaret:function(a,b){var c;0!==a&&(c=0<a?"next":"prev",this.isShiftDown?(c=this.$control_input[c](),c.length&&(this.hideInput(),this.setActiveItem(c),b&&b.preventDefault())):this.setCaret(this.caretPos+a))},setCaret:function(a){a="single"===this.settings.mode?this.items.length:Math.max(0,
Math.min(this.items.length,a));if(!this.isPending){var b,e,d,f;d=this.$control.children(":not(input)");b=0;for(e=d.length;b<e;b++)f=c(d[b]).detach(),b<a?this.$control_input.before(f):this.$control.append(f)}this.caretPos=a},lock:function(){this.close();this.isLocked=!0;this.refreshState()},unlock:function(){this.isLocked=!1;this.refreshState()},disable:function(){this.$input.prop("disabled",!0);this.$control_input.prop("disabled",!0).prop("tabindex",-1);this.isDisabled=!0;this.lock()},enable:function(){this.$input.prop("disabled",
!1);this.$control_input.prop("disabled",!1).prop("tabindex",this.tabIndex);this.isDisabled=!1;this.unlock()},destroy:function(){var a=this.eventNS,b=this.revertSettings;this.trigger("destroy");this.off();this.$wrapper.remove();this.$dropdown.remove();this.$input.html("").append(b.$children).removeAttr("tabindex").removeClass("selectized").attr({tabindex:b.tabindex}).show();this.$control_input.removeData("grow");this.$input.removeData("selectize");c(window).off(a);c(document).off(a);c(document.body).off(a);
delete this.$input[0].selectize},render:function(a,b){var e,d,h,k=!1;if("option"===a||"item"===a)e=f(b[this.settings.valueField]),k=!!e;if(k&&("undefined"===typeof this.renderCache[a]&&(this.renderCache[a]={}),this.renderCache[a].hasOwnProperty(e)))return this.renderCache[a][e];h=c(this.settings.render[a].apply(this,[b,t]));"option"===a||"option_create"===a?h.attr("data-selectable",""):"optgroup"===a&&(d=b[this.settings.optgroupValueField]||"",h.attr("data-group",d));"option"!==a&&"item"!==a||h.attr("data-value",
e||"");k&&(this.renderCache[a][e]=h[0]);return h[0]},clearCache:function(a){"undefined"===typeof a?this.renderCache={}:delete this.renderCache[a]},canCreate:function(a){if(!this.settings.create)return!1;var b=this.settings.createFilter;return a.length&&("function"!==typeof b||b.apply(this,[a]))&&("string"!==typeof b||(new RegExp(b)).test(a))&&(!(b instanceof RegExp)||b.test(a))}});w.count=0;w.defaults={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:!1,
createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,maxOptions:1E3,maxItems:null,hideSelected:null,addPrecedence:!1,selectOnTab:!1,preload:!1,allowEmptyOption:!1,closeAfterSelect:!1,scrollDuration:60,loadThrottle:300,loadingClass:"loading",dataAttr:"data-data",optgroupField:"optgroup",valueField:"value",labelField:"text",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"selectize-control",
inputClass:"selectize-input",dropdownClass:"selectize-dropdown",dropdownContentClass:"selectize-dropdown-content",dropdownParent:null,copyClassesToDropdown:!0,render:{}};c.fn.selectize=function(a){var b=c.fn.selectize.defaults,e=c.extend({},b,a),d=e.dataAttr,h=e.labelField,k=e.valueField,l=e.optgroupField,u=e.optgroupLabelField,m=e.optgroupValueField,p=function(a,b){var g,n,p,r,v=b.options,t={},C=function(a){a=d&&a.attr(d);return"string"===typeof a&&a.length?JSON.parse(a):null},H=function(a,d){a=
c(a);var g=f(a.val());if(g||e.allowEmptyOption)if(t.hasOwnProperty(g)){if(d){var n=t[g][l];n?c.isArray(n)?n.push(d):t[g][l]=[n,d]:t[g][l]=d}}else n=C(a)||{},n[h]=n[h]||a.text(),n[k]=n[k]||g,n[l]=n[l]||d,t[g]=n,v.push(n),a.is(":selected")&&b.items.push(g)},x=function(a){var e,d,g;a=c(a);if(d=a.attr("label"))e=C(a)||{},e[u]=d,e[m]=d,b.optgroups.push(e);g=c("option",a);a=0;for(e=g.length;a<e;a++)H(g[a],d)};b.maxItems=a.attr("multiple")?null:1;r=a.children();g=0;for(n=r.length;g<n;g++)p=r[g].tagName.toLowerCase(),
"optgroup"===p?x(r[g]):"option"===p&&H(r[g])};return this.each(function(){if(!this.selectize){var g=c(this),f=this.tagName.toLowerCase(),n=g.attr("placeholder")||g.attr("data-placeholder");n||e.allowEmptyOption||(n=g.children('option[value=""]').text());n={placeholder:n,options:[],optgroups:[],items:[]};if("select"===f)p(g,n);else{var l,u,m;if(f=g.attr(d))for(n.options=JSON.parse(f),f=0,l=n.options.length;f<l;f++)n.items.push(n.options[f][k]);else if(f=c.trim(g.val()||""),e.allowEmptyOption||f.length){u=
f.split(e.delimiter);f=0;for(l=u.length;f<l;f++)m={},m[h]=u[f],m[k]=u[f],n.options.push(m);n.items=u}}new w(g,c.extend(!0,{},b,n,a))}})};c.fn.selectize.defaults=w.defaults;c.fn.selectize.support={validity:k};w.define("drag_drop",function(a){if(!c.fn.sortable)throw Error('The "drag_drop" plugin requires jQuery UI "sortable".');if("multi"===this.settings.mode){var b=this;b.lock=function(){var a=b.lock;return function(){var c=b.$control.data("sortable");c&&c.disable();return a.apply(b,arguments)}}();
b.unlock=function(){var a=b.unlock;return function(){var c=b.$control.data("sortable");c&&c.enable();return a.apply(b,arguments)}}();b.setup=function(){var a=b.setup;return function(){a.apply(this,arguments);var e=b.$control.sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:b.isLocked,start:function(a,b){b.placeholder.css("width",b.helper.css("width"));e.css({overflow:"visible"})},stop:function(){e.css({overflow:"hidden"});var a=b.$activeItems?b.$activeItems.slice():null,d=[];e.children("[data-value]").each(function(){d.push(c(this).attr("data-value"))});
b.setValue(d);b.setActiveItem(a)}})}}()}});w.define("dropdown_header",function(a){var b=this;a=c.extend({title:"Untitled",headerClass:"selectize-dropdown-header",titleRowClass:"selectize-dropdown-header-title",labelClass:"selectize-dropdown-header-label",closeClass:"selectize-dropdown-header-close",html:function(a){return'<div class="'+a.headerClass+'"><div class="'+a.titleRowClass+'"><span class="'+a.labelClass+'">'+a.title+'</span><a href="javascript:void(0)" class="'+a.closeClass+'">&times;</a></div></div>'}},
a);b.setup=function(){var e=b.setup;return function(){e.apply(b,arguments);b.$dropdown_header=c(a.html(a));b.$dropdown.prepend(b.$dropdown_header)}}()});w.define("optgroup_columns",function(a){var b=this;a=c.extend({equalizeWidth:!0,equalizeHeight:!0},a);this.getAdjacentOption=function(a,b){var e=a.closest("[data-group]").find("[data-selectable]"),d=e.index(a)+b;return 0<=d&&d<e.length?e.eq(d):c()};this.onKeyDown=function(){var a=b.onKeyDown;return function(c){var e,d;if(!this.isOpen||37!==c.keyCode&&
39!==c.keyCode)return a.apply(this,arguments);b.ignoreHover=!0;d=this.$activeOption.closest("[data-group]");e=d.find("[data-selectable]").index(this.$activeOption);d=37===c.keyCode?d.prev("[data-group]"):d.next("[data-group]");d=d.find("[data-selectable]");e=d.eq(Math.min(d.length-1,e));e.length&&this.setActiveOption(e)}}();var e=function(){var a,b=e.width,c=document;"undefined"===typeof b&&(a=c.createElement("div"),a.innerHTML='<div style="width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;"><div style="width:1px;height:100px;"></div></div>',
a=a.firstChild,c.body.appendChild(a),b=e.width=a.offsetWidth-a.clientWidth,c.body.removeChild(a));return b},d=function(){var d,g,f,h;h=c("[data-group]",b.$dropdown_content);if((g=h.length)&&b.$dropdown_content.width()){if(a.equalizeHeight){for(d=f=0;d<g;d++)f=Math.max(f,h.eq(d).height());h.css({height:f})}a.equalizeWidth&&(f=b.$dropdown_content.innerWidth()-e(),d=Math.round(f/g),h.css({width:d}),1<g&&(d=f-d*(g-1),h.eq(g-1).css({width:d})))}};if(a.equalizeHeight||a.equalizeWidth)G.after(this,"positionDropdown",
d),G.after(this,"refreshOptions",d)});w.define("remove_button",function(a){a=c.extend({label:"&times;",title:"Remove",className:"remove",append:!0},a);var b=function(a,b){b.className="remove-single";var d='<a href="javascript:void(0)" class="'+b.className+'" tabindex="-1" title="'+t(b.title)+'">'+b.label+"</a>";a.setup=function(){var e=a.setup;return function(){if(b.append){var f=c(a.$input[0]).attr("id");c("#"+f);var g=a.settings.render.item;a.settings.render.item=function(b){return g.apply(a,arguments)+
d}}e.apply(a,arguments);a.$control.on("click","."+b.className,function(b){b.preventDefault();a.isLocked||a.clear()})}}()},d=function(a,b){var d='<a href="javascript:void(0)" class="'+b.className+'" tabindex="-1" title="'+t(b.title)+'">'+b.label+"</a>";a.setup=function(){var e=a.setup;return function(){if(b.append){var f=a.settings.render.item;a.settings.render.item=function(b){var c=f.apply(a,arguments),e=c.search(/(<\/[^>]+>\s*)$/);return c.substring(0,e)+d+c.substring(e)}}e.apply(a,arguments);a.$control.on("click",
"."+b.className,function(b){b.preventDefault();a.isLocked||(b=c(b.currentTarget).parent(),a.setActiveItem(b),a.deleteSelection()&&a.setCaret(a.items.length))})}}()};"single"===this.settings.mode?b(this,a):d(this,a)});w.define("restore_on_backspace",function(a){var b=this;a.text=a.text||function(a){return a[this.settings.labelField]};this.onKeyDown=function(){var c=b.onKeyDown;return function(b){var d;if(8===b.keyCode&&""===this.$control_input.val()&&!this.$activeItems.length&&(d=this.caretPos-1,0<=
d&&d<this.items.length)){d=this.options[this.items[d]];this.deleteSelection(b)&&(this.setTextboxValue(a.text.apply(this,[d])),this.refreshOptions(!0));b.preventDefault();return}return c.apply(this,arguments)}}()});return w});
