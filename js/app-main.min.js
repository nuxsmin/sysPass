var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(t,n,e){if(e.get||e.set)throw new TypeError("ES3 does not support getters and setters.");t!=Array.prototype&&t!=Object.prototype&&(t[n]=e.value)},$jscomp.getGlobal=function(t){return"undefined"!=typeof window&&window===t?t:"undefined"!=typeof global&&null!=global?global:t},$jscomp.global=$jscomp.getGlobal(this),$jscomp.SYMBOL_PREFIX="jscomp_symbol_",$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){},$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)},$jscomp.symbolCounter_=0,$jscomp.Symbol=function(t){return $jscomp.SYMBOL_PREFIX+(t||"")+$jscomp.symbolCounter_++},$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var t=$jscomp.global.Symbol.iterator;t||(t=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator")),"function"!=typeof Array.prototype[t]&&$jscomp.defineProperty(Array.prototype,t,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}}),$jscomp.initSymbolIterator=function(){}},$jscomp.arrayIterator=function(t){var n=0;return $jscomp.iteratorPrototype(function(){return n<t.length?{done:!1,value:t[n++]}:{done:!0}})},$jscomp.iteratorPrototype=function(t){return $jscomp.initSymbolIterator(),(t={next:t})[$jscomp.global.Symbol.iterator]=function(){return this},t},$jscomp.array=$jscomp.array||{},$jscomp.iteratorFromArray=function(t,n){$jscomp.initSymbolIterator(),t instanceof String&&(t+="");var e=0,o={next:function(){if(e<t.length){var r=e++;return{value:n(r,t[r]),done:!1}}return o.next=function(){return{done:!0,value:void 0}},o.next()}};return o[Symbol.iterator]=function(){return o},o},$jscomp.polyfill=function(t,n,e,o){if(n){for(e=$jscomp.global,t=t.split("."),o=0;o<t.length-1;o++){var r=t[o];r in e||(e[r]={}),e=e[r]}(n=n(o=e[t=t[t.length-1]]))!=o&&null!=n&&$jscomp.defineProperty(e,t,{configurable:!0,writable:!0,value:n})}},$jscomp.polyfill("Array.prototype.keys",function(t){return t||function(){return $jscomp.iteratorFromArray(this,function(t){return t})}},"es6-impl","es3"),$jscomp.findInternal=function(t,n,e){t instanceof String&&(t=String(t));for(var o=t.length,r=0;r<o;r++){var i=t[r];if(n.call(e,i,r,t))return{i:r,v:i}}return{i:-1,v:void 0}},$jscomp.polyfill("Array.prototype.find",function(t){return t||function(t,n){return $jscomp.findInternal(this,t,n).v}},"es6-impl","es3"),sysPass.Main=function(){var t={APP_ROOT:"",LANG:[],PK:"",MAX_FILE_SIZE:1024,CRYPT:new JSEncrypt,CHECK_UPDATES:!1,TIMEZONE:"",LOCALE:"",DEBUG:"",COOKIES_ENABLED:!1,PLUGINS:[],LOGGEDIN:!1},n={passLength:0,minPasswordLength:8,complexity:{patpass:"AAAAAAAAAAAA",symbpass:"!Â£$%&()=?@#-_[],.;:"}};Object.seal(n);var e={},o={},r={},i={},a={},s={},c={},l={log:function(n){!0===t.DEBUG&&console.log(n)},info:function(n){!0===t.DEBUG&&console.info(n)},error:function(t){console.error(t)},warn:function(t){console.warn(t)},debug:function(n){!0===t.DEBUG&&console.debug(n)}};Object.freeze(l),toastr.options={closeButton:!0,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-top-center",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};var u={ok:function(t){toastr.success(t)},error:function(t){toastr.error(t)},warn:function(t){toastr.warning(t)},info:function(t){toastr.info(t)},sticky:function(n,e){var o={timeOut:0};"function"==typeof e&&(o.onHidden=e),toastr.warning(n,t.LANG[60],o)},out:function(t){if("object"==typeof t){var n=t.status,e=t.description;switch(void 0!==t.messages&&0<t.messages.length&&(e=e+"<br>"+t.messages.join("<br>")),n){case 0:u.ok(e);break;case 1:case 2:case 4:u.error(e);break;case 3:u.warn(e);break;case 10:r.main.logout();break;case 100:u.ok(e),u.sticky(e);break;case 101:u.error(e),u.sticky(e);break;default:u.error(e)}}},html:{error:function(n){return'<p class="error round">Oops...<br>'+t.LANG[1]+"<br>"+n+"</p>"}}};Object.freeze(u),String.format||(String.format=function(t){var n=Array.prototype.slice.call(arguments,1);return t.replace(/{(\d+)}/g,function(t,e){return void 0!==n[e]?n[e]:t})});var f,p={current:"",get:function(){return l.info("sk:get"),$("#container").attr("data-sk")},set:function(t){l.info("sk:set"),$("#container").attr("data-sk",t),t.current=t}},d=function(){var t=$("#container");if(!t.hasClass("content-no-auto-resize")){var n=$("#content").height()+200;t.css("height",n)}},g=function(){$("html, body").animate({scrollTop:0},"slow")},m=function(){l.info("checkLogout"),1===parseInt(function(t){for(var n,e=[],o=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),r=0;r<o.length;r++)n=o[r].split("="),e.push(n[0]),e[n[0]]=n[1];return void 0!==t&&void 0!==e[t]?e[t]:e}("logout"))&&u.sticky(t.LANG[61],setTimeout(function(){h("index.php")},1e3))},h=function(t){window.location.replace(t)},y=function(n){var e={actionId:n.data("action-id"),itemId:n.data("item-id"),sk:p.get()},o={requestDoneAction:"",setRequestData:function(t){$.extend(e,t)},getRequestData:function(){return e},beforeSendAction:"",url:""},a=function(t){if(void 0===o.url||""===o.url)return!1;var n=new FormData;n.append("inFile",t),n.append("isAjax",1),e.sk=p.get(),Object.keys(e).forEach(function(t){n.append(t,e[t])}),(t=i.getRequestOpts()).url=o.url,t.processData=!1,t.contentType=!1,t.data=n,i.getActionCall(t,function(t){var n=t.status;t=t.description,0===n?("function"==typeof o.requestDoneAction&&o.requestDoneAction(),u.ok(t)):10===n?r.main.logout():u.error(t)})},s=function(e){if(5<e.length)u.error(t.LANG[17]+" (Max: 5)");else for(var o=0;o<e.length;o++){var r=e[o];if(r.size/1e3>t.MAX_FILE_SIZE)u.error(t.LANG[18]+"<br>"+r.name+" (Max: "+t.MAX_FILE_SIZE+")");else{var i;t:{i=r.name;for(var s=n.data("files-ext").toLowerCase().split(","),c=0;c<=s.length;c++)if(-1!==i.indexOf(s[c])){i=!0;break t}i=!1}i?a(e[o]):u.error(t.LANG[19]+"<br>"+r.name)}}},c=function(t){var n=$("#fileUploadForm");return!1===t&&n.hide(),(t=n.find("input[type='file']")).on("change",function(){"function"==typeof o.beforeSendAction&&o.beforeSendAction(),s(this.files)}),t};return window.File&&window.FileList&&window.FileReader?function(){l.info("fileUpload:init");var t=c(!1);n.on("dragover dragenter",function(t){l.info("fileUpload:drag"),t.stopPropagation(),t.preventDefault()}),n.on("drop",function(t){l.info("fileUpload:drop"),t.stopPropagation(),t.preventDefault(),"function"==typeof o.beforeSendAction&&o.beforeSendAction(),s(t.originalEvent.dataTransfer.files)}),n.on("click",function(){t.click()})}():c(!0),o},b=function(t){l.info("checkPassLevel"),n.passLength=t.val().length,v(zxcvbn(t.val()),t)},v=function(e,o){l.info("outputResult");var r=$(".passLevel-"+o.attr("id")),i=e.score;r.show(),r.removeClass("weak good strong strongest"),0===n.passLength?r.attr("title","").empty():n.passLength<n.minPasswordLength?r.attr("title",t.LANG[11]).addClass("weak"):0===i?r.attr("title",t.LANG[9]+" - "+e.feedback.warning).addClass("weak"):1===i||2===i?r.attr("title",t.LANG[8]+" - "+e.feedback.warning).addClass("good"):3===i?r.attr("title",t.LANG[7]).addClass("strong"):4===i&&r.attr("title",t.LANG[10]).addClass("strongest")},w=function(n){l.info("encryptFormValue");var e=n.val();""!==e&&parseInt(n.attr("data-length"))!==e.length&&(e=t.CRYPT.encrypt(e),n.val(e),n.attr("data-length",e.length))},A=function(t,n){if(l.info("Eval: "+t),"function"!=typeof t)throw Error("Function not found: "+t);t(n)},j=function(t){l.info("resizeImage");var n=.9*$(window).width(),e=.9*$(window).height(),o={width:t.width(),height:t.height()},r={calc:0,main:0,secondary:0,factor:.9,rel:o.width/o.height},i=function(t){return t.main>t.secondary?t.calc=t.main/t.rel:t.main<t.secondary&&(t.calc=t.main*t.rel),t.calc>t.secondary&&(t.main*=t.factor,i(t)),t};return o.width>n?function(){r.main=n,r.secondary=e;var a=i(r);t.css({width:a.main,height:a.calc}),o.width=a.main,o.height=a.calc}():o.height>e&&(l.info("height"),function(){r.main=e,r.secondary=n;var a=i(r);t.css({width:a.calc,height:a.main}),o.width=a.calc,o.height=a.main}()),o},k=(f=document.createElement("div"),function(t){return t&&"string"==typeof t&&(t=(t=t.replace(/<script[^>]*>([\S\s]*?)<\/script>/gim,"")).replace(/<\/?\w(?:[^"'>]|"[^"]*"|'[^']*')*>/gim,""),f.innerHTML=t,t=f.textContent,f.textContent=""),t});return l.info("init"),s={actions:function(){return r},triggers:function(){return o},theme:function(){return e},sk:p,msg:u,log:l,passwordData:n,outputResult:v,checkPassLevel:b,encryptFormValue:w,fileUpload:y,redirect:h,scrollUp:g,setContentSize:d},c=$.extend({log:l,config:function(){return t},appTheme:function(){return e},appActions:function(){return r},appTriggers:function(){return o},appRequests:function(){return i},appPlugins:function(){return a},evalAction:A,resizeImage:j},s),Object.freeze(s),Object.freeze(c),o=sysPass.Triggers(c),r=sysPass.Actions(c),i=sysPass.Requests(c),"function"==typeof sysPass.Theme&&(e=sysPass.Theme(c)),function(){l.info("getEnvironment");var n=window.location.pathname.split("/");t.APP_ROOT=window.location.protocol+"//"+window.location.host+function(){for(var t="",e=1;e<=n.length-2;e++)t+="/"+n[e];return t}();var e=i.getRequestOpts();return e.url="/ajax/ajax_getEnvironment.php",e.method="get",e.useLoading=!1,e.data={isAjax:1},i.getActionCall(e,function(n){t.LANG=n.lang,t.PK=n.pk,t.CHECK_UPDATES=n.check_updates,t.CRYPT.setPublicKey(n.pk),t.TIMEZONE=n.timezone,t.LOCALE=n.locale,t.DEBUG=n.debug,t.MAX_FILE_SIZE=parseInt(n.max_file_size),t.COOKIES_ENABLED=n.cookies_enabled,t.PLUGINS=n.plugins,t.LOGGEDIN=n.loggedin,Object.freeze(t)})}().then(function(){""!==t.PK&&(l.info("bindPassEncrypt"),$("body").on("blur",":input[type=password]",function(t){(t=$(this)).hasClass("passwordfield__no-pki")||w(t)}).on("keypress",":input[type=password]",function(t){13===t.keyCode&&(t.preventDefault(),t=$(this),w(t),t.closest("form").submit())})),!0===t.CHECK_UPDATES&&r.main.getUpdates(),!1===t.COOKIES_ENABLED&&u.sticky(t.LANG[64]),l.info("initializeClipboard"),clipboard.isSupported()?$("body").on("click",".clip-pass-button",function(){var n=r.account.copypass($(this)).done(function(t){if(0!==t.status)return u.out(t),!1;p.set(t.csrf)});!1!==n&&clipboard.copy(n.responseJSON.data.accpass).then(function(){u.ok(t.LANG[45])},function(n){u.error(t.LANG[46])})}).on("click",".dialog-clip-button",function(){var n=$(this.dataset.clipboardTarget);clipboard.copy(n.text()).then(function(){$(".dialog-text").removeClass("dialog-clip-copy"),n.addClass("dialog-clip-copy")},function(n){u.error(t.LANG[46])})}).on("click",".clip-pass-icon",function(){var n=$(this.dataset.clipboardTarget);clipboard.copy(k(n.val())).then(function(){u.ok(t.LANG[45])},function(n){u.error(t.LANG[46])})}):l.warn(t.LANG[65]),function(){l.info("setupCallbacks");var t=$("#container").data("page");""!==t&&"function"==typeof o.views[t]&&o.views[t](),0<$("footer").length&&o.views.footer(),$("#btnBack").click(function(){h("index.php")}),o.bodyHooks()}(),m(),l.info("initPlugins");for(var n=0;n<t.PLUGINS.length;n++){var e=t.PLUGINS[n];"function"==typeof sysPass.Plugin[e]&&(a[e]=sysPass.Plugin[e](c))}Object.freeze(a),!0===t.LOGGEDIN&&!0===t.CHECK_UPDATES&&function(){l.info("checkPluginUpdates");for(var n in a)"function"==typeof a[n].checkVersion&&a[n].checkVersion().then(function(n){0===n.status&&void 0!==n.data.plugin&&u.info(String.format(t.LANG[66],n.data.plugin,n.data.remoteVersion))})}()}),s};
