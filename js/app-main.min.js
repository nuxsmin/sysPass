var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,g,e){if(e.get||e.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[g]=e.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var g=0;return $jscomp.iteratorPrototype(function(){return g<a.length?{done:!1,value:a[g++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(a,g){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var e=0,c={next:function(){if(e<a.length){var f=e++;return{value:g(f,a[f]),done:!1}}c.next=function(){return{done:!0,value:void 0}};return c.next()}};c[Symbol.iterator]=function(){return c};return c};
$jscomp.polyfill=function(a,g,e,c){if(g){e=$jscomp.global;a=a.split(".");for(c=0;c<a.length-1;c++){var f=a[c];f in e||(e[f]={});e=e[f]}a=a[a.length-1];c=e[a];g=g(c);g!=c&&null!=g&&$jscomp.defineProperty(e,a,{configurable:!0,writable:!0,value:g})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");
$jscomp.findInternal=function(a,g,e){a instanceof String&&(a=String(a));for(var c=a.length,f=0;f<c;f++){var l=a[f];if(g.call(e,l,f,a))return{i:f,v:l}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,e){return $jscomp.findInternal(this,a,e).v}},"es6-impl","es3");
sysPass.Main=function(){var a={APP_ROOT:"",LANG:[],PK:"",MAX_FILE_SIZE:1024,CRYPT:new JSEncrypt,CHECK_UPDATES:!1,TIMEZONE:"",LOCALE:"",DEBUG:""},g={passLength:0,minPasswordLength:8,complexity:{numbers:!0,symbols:!0,uppercase:!0,numlength:12}},e={},c={},f={},l={},q={},m={},h={log:function(b){!0===a.DEBUG&&console.log(b)},info:function(b){!0===a.DEBUG&&console.info(b)},error:function(a){console.error(a)},warn:function(a){console.warn(a)}},p=alertify.logPosition("top right").closeLogOnClick(!0).delay(1E4),
k={ok:function(a){p.success(a)},error:function(a){p.error(a)},warn:function(a){p.warn(a)},info:function(a){p.info(a)},out:function(a){if("object"===typeof a){var b=a.status,d=a.description;"undefined"!==typeof a.messages&&0<a.messages.length&&(d=d+"<br>"+a.messages.join("<br>"));switch(b){case 0:k.ok(d);break;case 1:case 2:k.error(d);break;case 3:k.warn(d);break;case 10:f.main.logout()}}},html:{error:function(b){return'<p class="error round">Oops...<br>'+a.LANG[1]+"<br>"+b+"</p>"}}},v=function(b){h.info("getEnvironment");
var n=window.location.pathname.split("/"),d=window.location.protocol+"//"+window.location.host+function(){for(var a="",b=1;b<=n.length-2;b++)a+="/"+n[b];return a}(),c=l.getRequestOpts();c.url=d+"/ajax/ajax_getEnvironment.php";c.method="get";c.async=!1;c.useLoading=!1;c.data={isAjax:1};l.getActionCall(c,function(d){a.APP_ROOT=d.app_root;a.LANG=d.lang;a.PK=d.pk;a.CHECK_UPDATES=d.check_updates;a.CRYPT.setPublicKey(d.pk);a.TIMEZONE=d.timezone;a.LOCALE=d.locale;a.DEBUG=d.debug;"function"===typeof b&&b()})},
t={get:function(){h.info("sk:get");return $("#container").attr("data-sk")},set:function(a){h.info("sk:set");$("#container").attr("data-sk",a)}},w=function(){var a=$("#container");if(!a.hasClass("content-no-auto-resize")){var c=$("#content").height()+200;a.css("height",c)}},x=function(){$("html, body").animate({scrollTop:0},"slow")},y=function(a){window.location.replace(a)},z=function(b){var c=function(){return{actionId:b.data("action-id"),itemId:b.data("item-id"),sk:t.get()}},d={requestDoneAction:"",
requestData:function(a){c=function(){return a}},beforeSendAction:"",url:""},g=function(a){if("undefined"===typeof d.url||""===d.url)return!1;var b=new FormData;b.append("inFile",a);b.append("isAjax",1);var e=c();Object.keys(e).forEach(function(a){h.info(a);b.append(a,e[a])});a=l.getRequestOpts();a.url=d.url;a.processData=!1;a.contentType=!1;a.data=b;l.getActionCall(a,function(a){var b=a.status;a=a.description;0===b?("function"===typeof d.requestDoneAction&&d.requestDoneAction(),k.ok(a)):10===b?f.main.logout():
k.error(a)})},e=function(d){if(5<d.length)k.error(a.LANG[17]+" (Max: 5)");else for(var c=0;c<d.length;c++){var e=d[c];if(e.size/1E3>a.MAX_FILE_SIZE)k.error(a.LANG[18]+"<br>"+e.name+" (Max: "+a.MAX_FILE_SIZE+")");else{var f;a:{f=e.name;for(var n=b.data("files-ext").toLowerCase().split(","),h=0;h<=n.length;h++)if(-1!==f.indexOf(n[h])){f=!0;break a}f=!1}f?g(d[c]):k.error(a.LANG[19]+"<br>"+e.name)}}},m=function(a){var b=$("#fileUploadForm");!1===a&&b.hide();a=b.find("input[type='file']");a.on("change",
function(){"function"===typeof d.beforeSendAction&&d.beforeSendAction();e(this.files)});return a};window.File&&window.FileList&&window.FileReader?function(){h.info("fileUpload:init");var a=m(!1);b.on("dragover dragenter",function(a){h.info("fileUpload:drag");a.stopPropagation();a.preventDefault()});b.on("drop",function(a){h.info("fileUpload:drop");a.stopPropagation();a.preventDefault();"function"===typeof d.beforeSendAction&&d.beforeSendAction();e(a.dataTransfer.files)});b.on("click",function(){a.click()})}():
m(!0);return d},A=function(a){h.info("checkPassLevel");g.passLength=a.val().length;u(zxcvbn(a.val()),a)},u=function(b,c){h.info("outputResult");var d=$(".passLevel-"+c.attr("id")),e=b.score;d.show();d.removeClass("weak good strong strongest");0===g.passLength?d.attr("title","").empty():g.passLength<g.minPasswordLength?d.attr("title",a.LANG[11]).addClass("weak"):0===e?d.attr("title",a.LANG[9]+" - "+b.feedback.warning).addClass("weak"):1===e||2===e?d.attr("title",a.LANG[8]+" - "+b.feedback.warning).addClass("good"):
3===e?d.attr("title",a.LANG[7]).addClass("strong"):4===e&&d.attr("title",a.LANG[10]).addClass("strongest")},B=function(b){$(b).find(".checkbox").button({icons:{primary:"ui-icon-transferthick-e-w"}}).click(function(){var b=$(this);!0===b.prop("checked")?b.button("option","label",a.LANG[40]):b.button("option","label",a.LANG[41])})},r=function(b){h.info("encryptFormValue");var c=b.val();""!==c&&parseInt(b.attr("data-length"))!==c.length&&(c=a.CRYPT.encrypt(c),b.val(c),b.attr("data-length",c.length))},
C=function(){h.info("initializeClipboard");var b=new Clipboard(".clip-pass-button",{text:function(a){return f.account.copypass($(a)).responseJSON.accpass}});b.on("success",function(b){k.ok(a.LANG[45])});b.on("error",function(b){k.error(a.LANG[46])});var b=new Clipboard(".dialog-clip-pass-button"),c=new Clipboard(".dialog-clip-user-button");b.on("success",function(a){$(".dialog-pass-text").addClass("dialog-clip-pass-copy round");a.clearSelection()});c.on("success",function(a){a.clearSelection()})},
D=function(){h.info("bindPassEncrypt");$("body").on("blur",":input[type=password]",function(a){a=$(this);a.hasClass("passwordfield__no-pki")||r(a)}).on("keypress",":input[type=password]",function(a){13===a.keyCode&&(a.preventDefault(),a=$(this),r(a),a.closest("form").submit())})},E=function(a,c){console.info("Eval: "+a);if("function"===typeof a)a(c);else throw Error("Function not found: "+a);},F=function(){return $.extend({log:h,config:function(){return a},appTheme:function(){return e},appActions:function(){return f},
appTriggers:function(){return c},appRequests:function(){return l},evalAction:E},q)},G=function(){return{actions:function(){return f},triggers:function(){return c},sk:t,msg:k,log:h,passToClip:0,passwordData:g,outputResult:u,checkboxDetect:B,checkPassLevel:A,encryptFormValue:r,fileUpload:z,redirect:y,scrollUp:x,setContentSize:w}};(function(){h.info("init");q=G();m=F();c=sysPass.Triggers(m);f=sysPass.Actions(m);l=sysPass.Requests(m);v(function(){""!==a.PK&&D();"function"===typeof sysPass.Theme&&(e=sysPass.Theme(m));
!0===a.CHECK_UPDATES&&f.main.getUpdates();C();h.info("setupCallbacks");switch($("#container").data("page")){case "login":c.views.login();break;case "2fa":c.views.twofa();break;case "passreset":c.views.passreset()}0<$("footer").length&&c.views.footer()})})();return q};
