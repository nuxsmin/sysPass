var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,f,d){if(d.get||d.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[f]=d.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var f=0;return $jscomp.iteratorPrototype(function(){return f<a.length?{done:!1,value:a[f++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(a,f){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var d=0,b={next:function(){if(d<a.length){var g=d++;return{value:f(g,a[g]),done:!1}}b.next=function(){return{done:!0,value:void 0}};return b.next()}};b[Symbol.iterator]=function(){return b};return b};
$jscomp.polyfill=function(a,f,d,b){if(f){d=$jscomp.global;a=a.split(".");for(b=0;b<a.length-1;b++){var g=a[b];g in d||(d[g]={});d=d[g]}a=a[a.length-1];b=d[a];f=f(b);f!=b&&null!=f&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:f})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");
$jscomp.findInternal=function(a,f,d){a instanceof String&&(a=String(a));for(var b=a.length,g=0;g<b;g++){var l=a[g];if(f.call(d,l,g,a))return{i:g,v:l}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,d){return $jscomp.findInternal(this,a,d).v}},"es6-impl","es3");
sysPass.Main=function(){var a={APP_ROOT:"",LANG:[],PK:"",MAX_FILE_SIZE:1024,crypt:new JSEncrypt,CHECK_UPDATES:!1},f={passLength:0,minPasswordLength:8,complexity:{numbers:!0,symbols:!0,uppercase:!0,numlength:12}},d={},b={},g={},l={},q={},m={},h={log:function(a){console.log(a)},info:function(a){console.info(a)},error:function(a){console.error(a)},warn:function(a){console.warn(a)}},p=alertify.logPosition("top right").closeLogOnClick(!0).delay(1E4),k={ok:function(a){p.success(a)},error:function(a){p.error(a)},
warn:function(a){p.warn(a)},info:function(a){p.info(a)},out:function(a){if("object"===typeof a){var c=a.status,e=a.description;"undefined"!==typeof a.messages&&0<a.messages.length&&(e=e+"<br>"+a.messages.join("<br>"));switch(c){case 0:k.ok(e);break;case 1:case 2:k.error(e);break;case 3:k.warn(e);break;case 10:g.main.logout()}}},html:{error:function(c){return'<p class="error round">Oops...<br>'+a.LANG[1]+"<br>"+c+"</p>"}}},v=function(c){h.info("getEnvironment");var n=window.location.pathname.split("/"),
e=window.location.protocol+"//"+window.location.host+function(){for(var a="",c=1;c<=n.length-2;c++)a+="/"+n[c];return a}(),b=l.getRequestOpts();b.url=e+"/ajax/ajax_getEnvironment.php";b.method="get";b.async=!1;b.useLoading=!1;b.data={isAjax:1};l.getActionCall(b,function(e){a.APP_ROOT=e.app_root;a.LANG=e.lang;a.PK=e.pk;a.CHECK_UPDATES=e.check_updates;a.crypt.setPublicKey(e.pk);"function"===typeof c&&c()})},t={get:function(){h.info("sk:get");return $("#content").attr("data-sk")},set:function(a){h.info("sk:set");
$("#content").attr("data-sk",a)}},w=function(){var a=$("#container");if(!a.hasClass("content-no-auto-resize")){var b=$("#content").height()+200;a.css("height",b)}},x=function(){$("html, body").animate({scrollTop:0},"slow")},y=function(a){window.location.replace(a)},z=function(c){var b=function(){return{actionId:c.data("action-id"),itemId:c.data("item-id"),sk:t.get()}},e={requestDoneAction:"",requestData:function(a){b=function(){return a}},beforeSendAction:"",url:""},f=function(a){if("undefined"===
typeof e.url||""===e.url)return!1;var c=new FormData;c.append("inFile",a);c.append("isAjax",1);var d=b();Object.keys(d).forEach(function(a){h.info(a);c.append(a,d[a])});a=l.getRequestOpts();a.url=e.url;a.processData=!1;a.contentType=!1;a.data=c;l.getActionCall(a,function(a){var c=a.status;a=a.description;0===c?("function"===typeof e.requestDoneAction&&e.requestDoneAction(),k.ok(a)):10===c?g.main.logout():k.error(a)})},d=function(e){if(5<e.length)k.error(a.LANG[17]+" (Max: 5)");else for(var b=0;b<
e.length;b++){var d=e[b];if(d.size/1E3>a.MAX_FILE_SIZE)k.error(a.LANG[18]+"<br>"+d.name+" (Max: "+a.MAX_FILE_SIZE+")");else{var n;a:{n=d.name;for(var g=c.data("files-ext").toLowerCase().split(","),h=0;h<=g.length;h++)if(-1!==n.indexOf(g[h])){n=!0;break a}n=!1}n?f(e[b]):k.error(a.LANG[19]+"<br>"+d.name)}}},m=function(a){var c=$("#fileUploadForm");!1===a&&c.hide();a=c.find("input[type='file']");a.on("change",function(){"function"===typeof e.beforeSendAction&&e.beforeSendAction();d(this.files)});return a};
window.File&&window.FileList&&window.FileReader?function(){h.info("fileUpload:init");var a=m(!1);c.on("dragover dragenter",function(a){h.info("fileUpload:drag");a.stopPropagation();a.preventDefault()});c.on("drop",function(a){h.info("fileUpload:drop");a.stopPropagation();a.preventDefault();"function"===typeof e.beforeSendAction&&e.beforeSendAction();d(a.dataTransfer.files)});c.on("click",function(){a.click()})}():m(!0);return e},A=function(a){h.info("checkPassLevel");f.passLength=a.val().length;u(zxcvbn(a.val()),
a)},u=function(c,b){h.info("outputResult");var e=$(".passLevel-"+b.attr("id")),d=c.score;e.show();e.removeClass("weak good strong strongest");0===f.passLength?e.attr("title","").empty():f.passLength<f.minPasswordLength?e.attr("title",a.LANG[11]).addClass("weak"):0===d?e.attr("title",a.LANG[9]+" - "+c.feedback.warning).addClass("weak"):1===d||2===d?e.attr("title",a.LANG[8]+" - "+c.feedback.warning).addClass("good"):3===d?e.attr("title",a.LANG[7]).addClass("strong"):4===d&&e.attr("title",a.LANG[10]).addClass("strongest")},
B=function(c){$(c).find(".checkbox").button({icons:{primary:"ui-icon-transferthick-e-w"}}).click(function(){var c=$(this);!0===c.prop("checked")?c.button("option","label",a.LANG[40]):c.button("option","label",a.LANG[41])})},r=function(c){h.info("encryptFormValue");var b=c.val(),e=c+"-encrypted",d=c.next(':input[name="'+e+'"]');if(""!==b&&d.attr("name")!==e||""!==b&&d.attr("name")===e&&parseInt(c.next().val())!==b.length)b=a.crypt.encrypt(b),c.val(b),0<d.length?d.val(b.length):c.after('<input type="hidden" name="'+
e+'" value="'+b.length+'" />')},C=function(){h.info("initializeClipboard");var c=new Clipboard(".clip-pass-button",{text:function(a){return g.account.copypass($(a)).responseJSON.accpass}});c.on("success",function(c){k.ok(a.LANG[45])});c.on("error",function(c){k.error(a.LANG[46])});var c=new Clipboard(".dialog-clip-pass-button"),b=new Clipboard(".dialog-clip-user-button");c.on("success",function(a){$(".dialog-pass-text").addClass("dialog-clip-pass-copy round");a.clearSelection()});b.on("success",function(a){a.clearSelection()})},
D=function(){h.info("bindPassEncrypt");$("body").on("blur",":input[type=password]",function(a){a=$(this);a.hasClass("passwordfield__no-pki")||r(a)}).on("keypress",":input[type=password]",function(a){if(13===a.keyCode){a.preventDefault();a=$(this);var c=a.closest("form");r(a);c.submit()}})},E=function(a,b){console.info("Eval: "+a);if("function"===typeof a)a(b);else throw Error("Function not found: "+a);},F=function(){return $.extend({log:h,config:function(){return a},appTheme:function(){return d},
appActions:function(){return g},appTriggers:function(){return b},appRequests:function(){return l},evalAction:E},q)},G=function(){return{actions:function(){return g},triggers:function(){return b},sk:t,msg:k,passToClip:0,passwordData:f,outputResult:u,checkboxDetect:B,checkPassLevel:A,encryptFormValue:r,fileUpload:z,redirect:y,scrollUp:x,setContentSize:w}};(function(){h.info("init");q=G();m=F();b=sysPass.Triggers(m);g=sysPass.Actions(m);l=sysPass.Requests(m);v(function(){""!==a.PK&&D();"function"===
typeof sysPass.Theme&&(d=sysPass.Theme(m));!0===a.CHECK_UPDATES&&g.main.getUpdates();C();h.info("setupCallbacks");0<$("#boxLogin").length&&b.views.login();0<$("#searchbox").length&&b.views.search();0<$("footer").length&&b.views.footer()})})();return q};
