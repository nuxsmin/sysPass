var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,e,c){b instanceof String&&(b=String(b));for(var f=b.length,a=0;a<f;a++){var d=b[a];if(e.call(c,d,a,b))return{i:a,v:d}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,e,c){b!=Array.prototype&&b!=Object.prototype&&(b[e]=c.value)};
$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(b,e,c,f){if(e){c=$jscomp.global;b=b.split(".");for(f=0;f<b.length-1;f++){var a=b[f];a in c||(c[a]={});c=c[a]}b=b[b.length-1];f=c[b];e=e(f);e!=f&&null!=e&&$jscomp.defineProperty(c,b,{configurable:!0,writable:!0,value:e})}};
$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,c){return $jscomp.findInternal(this,b,c).v}},"es6","es3");
sysPass.Triggers=function(b){var e=function(a){var d={valueField:"id",labelField:"name",searchField:["name"],onInitialize:function(){var a=$(this.$wrapper[0]),d=$(this.$input[0]).siblings(".btn-add-select");1===d.length&&a.append(d)}};a.find(".select-box").each(function(a){var b=$(this);a={};!0===b.data("create")&&(a.create=!0);d.plugins=b.hasClass("select-box-deselect")?{clear_selection:{title:sysPassApp.config.LANG[51]}}:{};if(b.data("onchange")){var g=b.data("onchange").split("/");d.onChange=function(a){if(0<
a)if(2===g.length)sysPassApp.actions[g[0]][g[1]](b);else sysPassApp.actions[g[0]](b)}}b.selectize($.extend(a,d))});a.find("#allowed_exts").selectize({create:function(a){return{value:a.toUpperCase(),text:a.toUpperCase()}},createFilter:/^[a-z0-9]{1,4}$/i,plugins:["remove_button"]});a.find("#wikifilter").selectize({create:!0,createFilter:/^[a-z0-9:._-]+$/i,plugins:["remove_button"]});a.find(".select-items-tag").selectize({create:function(a){return{value:a.toLowerCase(),text:a.toLowerCase()}},createFilter:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/,
plugins:["remove_button"]})},c={main:function(a){b.info("views:main");clipboard.isSupported()||sysPassApp.msg.info(sysPassApp.config.LANG[65]);$(".btn-menu").click(function(){var a=$(this);"1"===a.attr("data-history-reset")&&sysPassApp.requests.history.reset();sysPassApp.actions.getContent({r:a.data("route")},a.data("view"))});sysPassApp.actions.notification.getActive();sysPassApp.config.STATUS.CHECK_NOTIFICATIONS&&setInterval(function(){sysPassApp.actions.notification.getActive()},12E4);if(0===a.data("upgraded"))sysPassApp.actions.getContent({r:"account/index"},
"search");else{a=$("#content");var d=a.data("page");c.common(a);if(""!==d&&"function"===typeof c[d])c[d]()}!0===sysPassApp.config.STATUS.CHECK_UPDATES&&sysPassApp.actions.main.getUpdates();!0===sysPassApp.config.STATUS.CHECK_NOTICES&&sysPassApp.actions.main.getNotices();"function"===typeof sysPassApp.theme.viewsTriggers.main&&sysPassApp.theme.viewsTriggers.main()},search:function(){b.info("views:search");var a=$("#frmSearch");0!==a.length&&(a.find("select, #rpp").on("change",function(){a.submit()}),
a.find("button.btn-clear").on("click",function(b){b.preventDefault();a.find('input[name="searchfav"]').val(0);a[0].reset()}),$("#globalSearch").click(function(){var b=1==$(this).prop("checked")?1:0;a.find("input[name='gsearch']").val(b);a.submit()}),"function"===typeof sysPassApp.theme.viewsTriggers.search&&sysPassApp.theme.viewsTriggers.search())},login:function(){b.info("views:login");var a=$("#frmLogin");sysPassApp.config.AUTH.AUTHBASIC_AUTOLOGIN&&"0"===a.find("input[name='loggedOut']").val()&&
(b.info("views:login:autologin"),sysPassApp.msg.info(sysPassApp.config.LANG[66]),sysPassApp.actions.main.login(a))},userpassreset:function(){b.info("views:userpassreset");var a=$("#frmUserPassReset");sysPassApp.theme.passwordDetect(a)},footer:function(){b.info("views:footer")},common:function(a){b.info("views:common");e(a);a.find(":input[name='sk']");"function"===typeof sysPassApp.theme.viewsTriggers.common&&sysPassApp.theme.viewsTriggers.common(a);f(a);sysPassApp.triggers.updateFormHash(a)},datatabs:function(){b.info("views:datatabs");
$(".datagrid-action-search>form").each(function(){var a=$(this);a.find("button.btn-clear").on("click",function(b){b.preventDefault();a.trigger("reset")})})},config:function(){b.info("views:config");var a=$("#drop-import-files");if(0<a.length){var d=sysPassApp.util.fileUpload(a);d.url=sysPassApp.util.getUrl(sysPassApp.actions.ajaxUrl.entrypoint,{r:a.data("action-route")});d.allowedMime=sysPassApp.config.FILES.IMPORT_ALLOWED_MIME;d.beforeSendAction=function(){d.setRequestData({sk:sysPassApp.sk.get(),
csvDelimiter:$("#csvDelimiter").val(),importPwd:$("#importPwd").val(),importMasterPwd:$("#importMasterPwd").val(),import_defaultuser:$("#import_defaultuser").val(),import_defaultgroup:$("#import_defaultgroup").val()})}}},account:function(){b.info("views:account");var a=$("#list-account-files");0<a.length&&sysPassApp.actions.account.listFiles(a);var d=$("#drop-account-files");if(0<d.length){var g=sysPassApp.util.fileUpload(d);g.url=sysPassApp.util.getUrl(sysPassApp.actions.ajaxUrl.entrypoint,{r:[d.data("action-route"),
d.data("item-id")]});g.allowedMime=sysPassApp.config.FILES.ACCOUNT_ALLOWED_MIME;g.requestDoneAction=function(){sysPassApp.actions.account.listFiles(a)}}d=$("#parent_account_id");0<d.length&&(d.on("change",function(){var a=$(this),b=$("#accountpass,#accountpassR");0<a[0].value?b.each(function(){$(this).prop("disabled","true");$(this).prop("required","false")}):b.each(function(){$(this).prop("disabled","");$(this).prop("required","true")})}),sysPassApp.actions.items.get(d))},install:function(){b.info("views:install");
var a=$("#frmInstall");sysPassApp.theme.passwordDetect(a);e(a)}},f=function(a){b.info("initializeTags");a.find(".select-box-tags").selectize({persist:!1,valueField:"id",labelField:"name",searchField:["name"],plugins:["remove_button"],onInitialize:function(){var a=$(this.$wrapper[0]),b=$(this.$input[0]),c=this.getValue();""!==c&&b.attr("data-hash",sysPassApp.util.hash.md5(c.join()));c=b.data("currentItemId");void 0!==c&&this.removeOption(c,!0);c=b.siblings(".btn-add-select");1===c.length&&a.append(c);
b=b.siblings(".select-icon");1===b.length&&a.prepend(b)},onChange:function(){var a=$(this.$input[0]),b=sysPassApp.util.hash.md5(this.getValue().join())!==a.data("hash");a.attr("data-updated",b)}})};return{views:c,selectDetect:e,updateSk:function(){$("#content").find("[data-sk]").each(function(){b.info("updateSk");$(this).data("sk",sysPassApp.sk.get())})},updateFormHash:function(a){b.info("updateFormHash");a=void 0!==a?a.find(".form-action[data-hash]"):$(".form-action[data-hash]");0<a.length&&a.each(function(){var a=
$(this);a.attr("data-hash",sysPassApp.util.hash.md5(a.serialize()))})},bodyHooks:function(){b.info("bodyHooks");$("body").on("click","button.btn-action[data-onclick][type='button'],li.btn-action[data-onclick],span.btn-action[data-onclick],i.btn-action[data-onclick],a.btn-action[data-onclick],.btn-action-pager[data-onclick]",function(){var a=$(this);b.info("handleActionButton: "+a.attr("id"));var d=a.data("onclick").split("/");var c=a.data("plugin");c=void 0!==c&&void 0!==sysPassApp.plugins[c]?sysPassApp.plugins[c]:
sysPassApp.actions;if(2===d.length)c[d[0]][d[1]](a);else c[d[0]](a)}).on("click",".btn-back",function(){if(0<sysPassApp.requests.history.length()){b.info("back");var a=sysPassApp.requests.history.del();a.hasOwnProperty("data")?a.data.sk=sysPassApp.sk.get():a.data={sk:sysPassApp.sk.get()};sysPassApp.requests.getActionCall(a,a.callback)}}).on("submit",".form-action",function(a){a.preventDefault();a=$(this);b.info("formAction");var d=a.attr("data-hash"),c=sysPassApp.util.hash.md5(a.serialize());if(d===
c)sysPassApp.msg.ok(sysPassApp.config.LANG[55]);else if(d=a.data("plugin"),d=void 0!==d&&void 0!==sysPassApp.plugins[d]?sysPassApp.plugins[d]:sysPassApp.actions,c=a.data("onsubmit").split("/"),a.find("input[name='sk']").val(sysPassApp.sk.get()),2===c.length)d[c[0]][c[1]](a);else d[c[0]](a)}).on("click",".btn-help[data-help]",function(){var a=$(this);a=$.find("div[for='"+a.data("help")+"']");if(0<a.length){var b=sysPassApp.config.LANG[54]+" - "+a[0].getAttribute("title")||sysPassApp.config.LANG[54];
mdlDialog().show({title:b,text:a[0].innerHTML,positive:{title:sysPassApp.config.LANG[43]}})}}).on("reset",".form-action",function(a){a.preventDefault();b.info("reset");a=$(this);a.find("input:text, input:password, input:file, textarea").val("").parent("div").removeClass("is-dirty");a.find("input:radio, input:checkbox").prop("checked",!1).prop("selected",!1);a.find("input[name='start'], input[name='skey'], input[name='sorder']").val(0);a.find("select").each(function(){$(this)[0].selectize.clear(!0)});
a.submit()}).on("click",".btn-popup-close",function(a){$.magnificPopup.close()}).on("theme:update",function(){b.debug("on:theme:update");var a=$("#box-popup");0<a.length?sysPassApp.util.focus(a):sysPassApp.util.focus($(this))})}}};
